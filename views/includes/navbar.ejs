<style>

/* ================= NAVBAR BASE ================= */
.navbar {
  background: rgba(255,255,255,0.75);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  padding: 0.8rem 1.5rem;
  transition: all 0.3s ease;
  z-index: 1000;
}

.navbar.scrolled {
  box-shadow: 0 4px 20px rgba(0,0,0,0.08);
}

/* Logo */
.navbar-brand i {
  font-size: 1.8rem;
  color: #ff385c;
}

/* ================= FLOATING SEARCH ================= */

.search-pill {
  background: white;
  border-radius: 50px;
  padding: 6px 8px 6px 18px;
  display: flex;
  align-items: center;
  gap: 10px;
  cursor: pointer;
  box-shadow: 0 2px 15px rgba(0,0,0,0.08);
  transition: all 0.3s ease;
}

.search-pill:hover {
  box-shadow: 0 4px 20px rgba(0,0,0,0.15);
}

.search-pill span {
  font-size: 0.9rem;
  font-weight: 500;
}

.search-circle {
  background: #ff385c;
  color: white;
  height: 34px;
  width: 34px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* ================= SEARCH MODAL ================= */

.search-modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.4);
  display: none;
  align-items: flex-start;
  justify-content: center;
  padding-top: 100px;
  z-index: 2000;
  animation: fadeIn 0.3s ease;
}

.search-modal.active {
  display: flex;
}

.search-box {
  background: white;
  width: 600px;
  max-width: 95%;
  border-radius: 20px;
  padding: 20px;
  box-shadow: 0 15px 40px rgba(0,0,0,0.2);
  animation: slideDown 0.3s ease;
}

.search-box input {
  width: 100%;
  border: none;
  outline: none;
  font-size: 1.1rem;
  padding: 12px;
}

/* Animations */
@keyframes fadeIn {
  from {opacity: 0;}
  to {opacity: 1;}
}

@keyframes slideDown {
  from {transform: translateY(-20px); opacity: 0;}
  to {transform: translateY(0); opacity: 1;}
}

/* ================= PROFILE MENU ================= */

.profile-menu {
  display: flex;
  align-items: center;
  border: 1px solid #ddd;
  padding: 5px 10px;
  border-radius: 50px;
  cursor: pointer;
}

.profile-avatar {
  width: 32px;
  height: 32px;
  background: #ddd;
  border-radius: 50%;
  margin-left: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* ================= MOBILE ================= */

@media (max-width: 768px) {

  .search-pill span {
    display: none;
  }

  .search-pill {
    padding: 6px;
  }

  .search-box {
    width: 95%;
    padding: 15px;
  }

}

</style>


<nav class="navbar navbar-expand-md sticky-top border-bottom" id="mainNavbar">
  <div class="container-fluid">

    <!-- Logo -->
    <a class="navbar-brand" href="/listings">
      <i class="fa-regular fa-compass"></i>
    </a>

    <!-- Center Floating Search -->
    <div class="mx-auto">
      <div class="search-pill" id="openSearch">
        <span>Anywhere</span>
        <span>|</span>
        <span>Any week</span>
        <span>|</span>
        <span>Add guests</span>

        <div class="search-circle">
          <i class="fa-solid fa-magnifying-glass"></i>
        </div>
      </div>
    </div>

    <!-- Right Side -->
    <div class="d-flex align-items-center">

      <a class="nav-link me-3" href="/listings/new">
        Airbnb your home
      </a>

      <div class="dropdown">
        <div class="profile-menu" data-bs-toggle="dropdown">
          <i class="fa-solid fa-bars"></i>
          <div class="profile-avatar">
            <% if(currentUser){ %>
              <%= currentUser.username.charAt(0).toUpperCase() %>
            <% } else { %>
              <i class="fa-solid fa-user"></i>
            <% } %>
          </div>
        </div>

        <ul class="dropdown-menu dropdown-menu-end">
          <% if(!currentUser){ %>
            <li><a class="dropdown-item" href="/signup">Signup</a></li>
            <li><a class="dropdown-item" href="/login">Login</a></li>
          <% } else { %>
            <li><span class="dropdown-item-text fw-bold">
              Hello, <%= currentUser.username %>
            </span></li>
            <li><hr class="dropdown-divider"></li>
            <li>
              <form action="/logout" method="POST">
                <button class="dropdown-item">Logout</button>
              </form>
            </li>
          <% } %>
        </ul>
      </div>

    </div>

  </div>
</nav>


<!-- ================= SEARCH MODAL ================= -->
<div class="search-modal" id="searchModal">
  <div class="search-box">
    <form action="/listings" method="GET">
      <input
        type="text"
        name="search"
        placeholder="Search destinations..."
        autofocus
      >
    </form>
  </div>
</div>


<script>

/* Open Search */
const openSearch = document.getElementById("openSearch");
const searchModal = document.getElementById("searchModal");

openSearch.addEventListener("click", () => {
  searchModal.classList.add("active");
});

/* Close When Clicking Outside */
searchModal.addEventListener("click", (e) => {
  if(e.target === searchModal){
    searchModal.classList.remove("active");
  }
});

/* Navbar Shadow */
window.addEventListener("scroll", () => {
  const navbar = document.getElementById("mainNavbar");
  window.scrollY > 10
    ? navbar.classList.add("scrolled")
    : navbar.classList.remove("scrolled");
});

</script>
